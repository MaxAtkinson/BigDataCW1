MATCH (p:Playlist {id: 1})-[:CONTAINS]->(t:Track)
WITH DISTINCT(t.genreName) as c, COUNT(t) as size
RETURN c, size
ORDER BY size DESC

MATCH (emp:Employee)<-[:SUPPORTED_BY]-(cus:Customer)<-[:BILLED_TO]-(i:Invoice)
WITH DISTINCT(emp) as employee, sum(i.total) as total
RETURN employee, total
ORDER BY total DESC

MATCH (p:Playlist)-[:CONTAINS]->(track:Track)-[:ON]->(album:Album)-[:BY]->(ar:Artist)
WITH DISTINCT(ar) as artist, COUNT(track) as total
RETURN artist, total
ORDER BY total DESC

MATCH (t:Track)<-[:FOR]-(il:InvoiceLine)
WITH DISTINCT(t) as track, SUM(il.unitPrice * il.quantity) as total
RETURN total, track
ORDER BY total DESC

MATCH (c:Customer)<-[:BILLED_TO]-(i:Invoice)<-[:IN]-(il:InvoiceLine)-[:FOR]->(t:Track)-[:ON]->(al:Album)-[:BY]->(art:Artist)
WITH distinct(i.billingCountry) as country, art.name as name, COUNT(i) as amount
return country, max(amount)
ORDER BY country

